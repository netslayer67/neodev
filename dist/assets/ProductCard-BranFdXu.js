import{r as t,b as R,j as e,m as b,L as E,A}from"./index-BsrOXSwk.js";import{H as L}from"./heart-DTHs4ini.js";import{E as $}from"./eye-Ck7acUNt.js";const C=5e3,j=6,S=.32,f="animate-pulse bg-gradient-to-r from-muted/20 via-muted/40 to-muted/20",z=t.memo(()=>e.jsx("span",{className:"absolute top-2 left-2 z-20 rounded-full border border-border/40 bg-card/60 px-2 py-0.5 text-[10px] font-medium text-foreground backdrop-blur-md shadow-sm",children:"Fresh Drop"})),F=t.memo(()=>e.jsxs("div",{className:"absolute top-2 right-2 z-30 flex flex-col gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-320",children:[e.jsx("button",{className:"rounded-full border border-border bg-card/70 p-2 text-foreground backdrop-blur-md hover:bg-accent/30 transition-colors duration-320","aria-label":"Wishlist",children:e.jsx(L,{size:14})}),e.jsx("button",{className:"rounded-full border border-border bg-card/70 p-2 text-foreground backdrop-blur-md hover:bg-accent/30 transition-colors duration-320","aria-label":"Quick View",children:e.jsx($,{size:14})})]})),T=t.memo(()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative aspect-[3/4] overflow-hidden rounded-t-2xl",children:[e.jsx("div",{className:`w-full h-full ${f}`}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background/95 via-background/40 to-transparent z-10"})]}),e.jsxs("div",{className:"relative z-20 space-y-2 p-4",children:[e.jsx("div",{className:`h-4 w-3/4 rounded-md ${f}`}),e.jsx("div",{className:`h-3 w-1/2 rounded-md ${f}`}),e.jsx("div",{className:"mt-3 flex items-center justify-between",children:e.jsx("div",{className:`h-4 w-1/3 rounded-md ${f}`})})]})]})),O=t.memo(({images:r,currentImage:n,productName:d})=>{const[o,a]=t.useState(!1),[i,h]=t.useState(!1),c=r?.[n],u=c?.url||"https://via.placeholder.com/400x533/1a1a2e/ffffff?text=No+Image";return e.jsxs("div",{className:"relative aspect-[3/4] overflow-hidden rounded-t-2xl bg-muted/20",children:[e.jsx(A,{mode:"wait",children:e.jsx(b.img,{src:u,alt:c?.alt||d||"Product",loading:"lazy",decoding:"async",onLoad:()=>a(!0),onError:()=>{h(!0),a(!0)},initial:{opacity:0},animate:{opacity:o?1:0},exit:{opacity:0},transition:{duration:.4,ease:"easeOut"},className:`absolute inset-0 h-full w-full object-cover transition-transform duration-500 group-hover:scale-102 ${i?"object-contain bg-muted/10":""}`,style:{willChange:"transform"}},`${c?.url}-${n}`)}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background/90 via-background/20 to-transparent z-10"}),!o&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-muted/10",children:e.jsx("div",{className:"w-8 h-8 border-2 border-accent/30 border-t-accent rounded-full animate-spin"})})]})}),P=t.memo(({product:r})=>e.jsxs("div",{className:"relative z-20 space-y-1 p-4",children:[e.jsx("h3",{className:"font-heading text-base sm:text-lg line-clamp-2 group-hover:text-accent transition-colors duration-320",children:r.name}),e.jsx("p",{className:"text-xs font-sans text-muted-foreground",children:r.category}),e.jsx("div",{className:"mt-2 flex items-center justify-between",children:e.jsxs("span",{className:"text-sm font-semibold text-accent",children:["Rp ",r.price?.toLocaleString("id-ID")||"0"]})})]})),V=t.memo(({product:r,loading:n=!1,index:d=null})=>{const o=t.useRef(null),a=t.useRef(null),i=t.useRef(null),[h,c]=t.useState(0),[u,g]=t.useState(!1),s=R(),x=typeof window<"u"&&window.innerWidth<768,p=t.useMemo(()=>r?.images?.length>1,[r?.images?.length]),w=t.useMemo(()=>!n&&d===0,[n,d]);t.useEffect(()=>{if(!(!p||n||s))return i.current=setInterval(()=>c(m=>(m+1)%r.images.length),C),()=>clearInterval(i.current)},[p,n,r?.images?.length,s]);const N=t.useCallback(m=>{x||s||!u||(a.current&&cancelAnimationFrame(a.current),a.current=requestAnimationFrame(()=>{const l=o.current.getBoundingClientRect(),k=(m.clientY-l.top-l.height/2)/l.height*j,M=(m.clientX-l.left-l.width/2)/l.width*-j;o.current.style.transform=`perspective(1000px) rotateX(${k}deg) rotateY(${M}deg)`}))},[u,x,s]),y=t.useCallback(()=>g(!0),[]),I=t.useCallback(()=>{g(!1),a.current&&cancelAnimationFrame(a.current),o.current&&!s&&(o.current.style.transform="perspective(1000px) rotateX(0deg) rotateY(0deg)")},[s]);t.useEffect(()=>()=>{a.current&&cancelAnimationFrame(a.current),i.current&&clearInterval(i.current)},[]);const v=t.useMemo(()=>({hidden:{opacity:0,y:s?0:20},visible:{opacity:1,y:0,transition:{duration:s?.1:S,ease:"easeOut"}}}),[s]);return n?e.jsx(b.div,{variants:v,initial:"hidden",animate:"visible",className:"group relative w-full overflow-hidden rounded-2xl border border-border/30 bg-card/40 backdrop-blur-md shadow-md",children:e.jsx(T,{})}):!r||!r.slug?null:e.jsx(b.div,{ref:o,variants:v,initial:"hidden",whileInView:"visible",viewport:{once:!0,margin:"100px"},onMouseMove:N,onMouseEnter:y,onMouseLeave:I,className:"group relative w-full transition-all duration-320 will-change-transform",style:{transformStyle:"preserve-3d",backfaceVisibility:"hidden"},children:e.jsxs(E,{to:`/product/${r.slug}`,className:"block overflow-hidden rounded-2xl border border-border/50 bg-card/60 backdrop-blur-xl shadow-lg transition-all duration-320 hover:shadow-xl hover:shadow-accent/5 hover:border-accent/40 focus:outline-none focus:ring-2 focus:ring-accent/50","aria-label":`View details for ${r.name}`,children:[!s&&e.jsx(b.div,{className:"absolute -top-8 -right-8 w-24 h-24 rounded-full bg-accent/10 blur-2xl opacity-0 group-hover:opacity-60 transition-opacity duration-320",animate:{scale:[1,1.1,1]},transition:{duration:4,repeat:1/0,ease:"easeInOut"}}),e.jsx(O,{images:r.images,currentImage:h,productName:r.name}),w&&e.jsx(z,{}),e.jsx(F,{}),e.jsx(P,{product:r})]})})});V.displayName="ProductCard";export{V as default};
