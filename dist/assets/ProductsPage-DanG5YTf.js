import{o as w,r as o,j as e,K as k,R as H,I as v,B as x,h as B,m as q,X as _,O as U,u as G,a as Q,f as M,Q as V,a3 as Z,a4 as J,a5 as K}from"./index-prnh0kJO.js";import{D as L,a as O,b as R,c as T}from"./dialog-Aj-kJqfr.js";import"./label-BLVgaqYa.js";import{P as z}from"./package-I5PBfAKd.js";import{C as X}from"./check-circle-BuVzsy5i.js";import{M as Y,P as W}from"./plus-CY1B7mqH.js";const P=w("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),I=w("Badge",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}]]),ee=w("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),se=w("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]),ae=w("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),te=w("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),A=o.forwardRef(({className:l,...c},n)=>e.jsx("div",{ref:n,className:k("rounded-lg border bg-card text-card-foreground shadow-sm",l),...c}));A.displayName="Card";const D=o.forwardRef(({className:l,...c},n)=>e.jsx("div",{ref:n,className:k("flex flex-col space-y-1.5 p-6",l),...c}));D.displayName="CardHeader";const ne=o.forwardRef(({className:l,...c},n)=>e.jsx("h3",{ref:n,className:k("text-2xl font-semibold leading-none tracking-tight",l),...c}));ne.displayName="CardTitle";const re=o.forwardRef(({className:l,...c},n)=>e.jsx("p",{ref:n,className:k("text-sm text-muted-foreground",l),...c}));re.displayName="CardDescription";const F=o.forwardRef(({className:l,...c},n)=>e.jsx("div",{ref:n,className:k("p-6 pt-0",l),...c}));F.displayName="CardContent";const le=o.forwardRef(({className:l,...c},n)=>e.jsx("div",{ref:n,className:k("flex items-center p-6 pt-0",l),...c}));le.displayName="CardFooter";const $=H.forwardRef(({className:l="",...c},n)=>e.jsx("textarea",{ref:n,className:`w-full p-3 rounded-xl border border-white/10 bg-white/10 text-white/90 placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/20 ${l}`,...c}));$.displayName="Textarea";function ie({open:l,onClose:c,product:n,onSubmit:j,loading:u}){const[i,m]=o.useState({name:"",description:"",price:"",category:"",images:[],sizes:[]}),[g,y]=o.useState(null);o.useEffect(()=>{m(n?{name:n.name||"",description:n.description||"",price:n.price||"",category:n.category||"",images:[],sizes:n.sizes||[]}:{name:"",description:"",price:"",category:"",images:[],sizes:[]})},[n]);const d=s=>{const{name:a,value:r,files:h}=s.target;m(h?t=>({...t,images:[...t.images,...Array.from(h)]}):t=>({...t,[a]:r}))},f=(s,a,r)=>{const h=[...i.sizes];h[s][a]=r,m(t=>({...t,sizes:h}))},b=()=>{m(s=>({...s,sizes:[...s.sizes,{size:"",quantity:0}]}))},S=s=>{const a=[...i.sizes];a.splice(s,1),m(r=>({...r,sizes:a}))},N=s=>y(s),C=(s,a)=>{if(s.preventDefault(),g===a)return;const r=[...i.images],h=r[g];r.splice(g,1),r.splice(a,0,h),y(a),m(t=>({...t,images:r}))},p=s=>{s.preventDefault();const a=new FormData;a.append("name",i.name.trim()),a.append("description",i.description.trim()),a.append("price",i.price),a.append("category",i.category),i.images.forEach(r=>{a.append("images",r)}),a.append("sizes",JSON.stringify(i.sizes)),j(a)};return e.jsx(L,{open:l,onOpenChange:s=>!s&&c(),children:e.jsxs(O,{className:"sm:max-w-lg rounded-2xl bg-background/80 backdrop-blur-xl border border-border shadow-xl",children:[e.jsx(R,{children:e.jsx(T,{className:"text-xl font-bold",children:n?"Edit Product":"Add Product"})}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsx(v,{name:"name",placeholder:"Product name",value:i.name,onChange:d,required:!0}),e.jsx($,{name:"description",placeholder:"Description",value:i.description,onChange:d,rows:3}),e.jsx(v,{type:"number",name:"price",placeholder:"Price",value:i.price,onChange:d,required:!0}),e.jsxs("select",{name:"category",value:i.category,onChange:d,required:!0,className:"w-full rounded border p-2 bg-background",children:[e.jsx("option",{value:"",children:"-- Select Category --"}),e.jsx("option",{value:"Outerwear",children:"T-Shirt"}),e.jsx("option",{value:"Hoodie",children:"Hoodie"}),e.jsx("option",{value:"pants",children:"Pants"})]}),e.jsx(v,{type:"file",name:"images",accept:"image/*",multiple:!0,onChange:d}),i.images.length>0&&e.jsx("div",{className:"flex gap-2 flex-wrap",children:i.images.map((s,a)=>e.jsxs("div",{draggable:!0,onDragStart:()=>N(a),onDragOver:r=>C(r,a),className:"relative",children:[e.jsx("img",{src:URL.createObjectURL(s),alt:`preview-${a}`,className:`w-20 h-20 object-cover rounded border ${a===0?"ring-2 ring-blue-500":""}`}),a===0&&e.jsx("span",{className:"absolute top-1 left-1 bg-blue-500 text-white text-xs px-1 rounded",children:"Main"})]},a))}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-semibold",children:"Sizes"}),e.jsx(x,{type:"button",size:"sm",variant:"outline",onClick:b,children:"Add Size"})]}),i.sizes.map((s,a)=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(v,{type:"text",placeholder:"Size (e.g. S, M, L)",value:s.size,onChange:r=>f(a,"size",r.target.value)}),e.jsx(v,{type:"number",placeholder:"Quantity",value:s.quantity,onChange:r=>f(a,"quantity",r.target.value)}),e.jsx(x,{type:"button",variant:"destructive",size:"sm",onClick:()=>S(a),children:"âœ•"})]},a))]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(x,{variant:"outline",type:"button",onClick:c,children:"Cancel"}),e.jsx(x,{type:"submit",disabled:u,className:"btn-accent",children:u?"Saving...":n?"Update":"Create"})]})]})]})})}const ce=({isOpen:l,onClose:c,product:n})=>{const{toast:j}=B(),[u,i]=o.useState([]),[m,g]=o.useState(!1),[y,d]=o.useState(!1);o.useEffect(()=>{n&&n.sizes&&(i([...n.sizes]),d(!1))},[n,l]);const f=(s,a)=>{const r=Math.max(0,parseInt(a)||0);i(h=>h.map(t=>t.size===s?{...t,quantity:r}:t)),d(!0)},b=s=>{i(a=>a.map(r=>r.size===s?{...r,quantity:r.quantity+1}:r)),d(!0)},S=s=>{i(a=>a.map(r=>r.size===s?{...r,quantity:Math.max(0,r.quantity-1)}:r)),d(!0)},N=async()=>{g(!0);try{const s=u.map(a=>U.patch(`/products/${n._id}/stock`,{size:a.size,quantity:a.quantity}));await Promise.all(s),j({title:"Success",description:"Stock levels updated successfully",className:"bg-success/10 border-success/20"}),d(!1),c()}catch(s){j({variant:"destructive",title:"Failed",description:s.message||"Failed to update stock levels",className:"bg-error/10 border-error/20"})}finally{g(!1)}},C=u.reduce((s,a)=>s+a.quantity,0),p=u.filter(s=>s.quantity<=5);return n?e.jsx(L,{open:l,onOpenChange:c,children:e.jsxs(O,{className:"glass-card border-border max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(R,{children:e.jsxs(T,{className:"flex items-center gap-3",children:[e.jsx(z,{className:"w-6 h-6 text-accent"}),"Stock Management - ",n.name]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"glass-card p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Stock"}),e.jsx("p",{className:"text-2xl font-bold text-foreground",children:C})]}),e.jsx(z,{className:"w-8 h-8 text-accent"})]})}),e.jsx("div",{className:"glass-card p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Low Stock Items"}),e.jsx("p",{className:"text-2xl font-bold text-foreground",children:p.length})]}),p.length>0?e.jsx(P,{className:"w-8 h-8 text-warning"}):e.jsx(X,{className:"w-8 h-8 text-success"})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Stock by Size"}),e.jsx("div",{className:"grid gap-4",children:u.map(s=>e.jsx(q.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`glass-card p-4 border-l-4 ${s.quantity<=5?"border-l-warning bg-warning/5":s.quantity===0?"border-l-error bg-error/5":"border-l-success bg-success/5"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-accent/10 flex items-center justify-center",children:e.jsx("span",{className:"text-lg font-bold text-accent",children:s.size})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-foreground",children:["Size ",s.size]}),e.jsx("p",{className:`text-sm ${s.quantity<=5?"text-warning":s.quantity===0?"text-error":"text-success"}`,children:s.quantity<=5?s.quantity===0?"Out of stock":"Low stock":"In stock"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(x,{variant:"outline",size:"sm",onClick:()=>S(s.size),disabled:s.quantity<=0,className:"w-8 h-8 p-0",children:e.jsx(Y,{className:"w-4 h-4"})}),e.jsx(v,{type:"number",value:s.quantity,onChange:a=>f(s.size,a.target.value),className:"w-20 text-center",min:"0"}),e.jsx(x,{variant:"outline",size:"sm",onClick:()=>b(s.size),className:"w-8 h-8 p-0",children:e.jsx(W,{className:"w-4 h-4"})})]})]})},s.size))})]}),p.length>0&&e.jsx(q.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"glass-card p-4 border border-warning/20 bg-warning/5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(P,{className:"w-5 h-5 text-warning mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-warning",children:"Low Stock Alert"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["The following sizes have low stock (â‰¤5 items):",p.map(s=>` ${s.size}(${s.quantity})`).join(", ")]})]})]})}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-border",children:[e.jsxs(x,{variant:"outline",onClick:c,className:"flex-1",disabled:m,children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsx(x,{onClick:N,className:"flex-1",disabled:m||!y,children:m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin mr-2"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})]})]})]})}):null};function pe(){const l=G(),{items:c,status:n,error:j}=Q(t=>t.products),[u,i]=o.useState("grid"),[m,g]=o.useState(""),[y,d]=o.useState(!1),[f,b]=o.useState(null),[S,N]=o.useState(!1),[C,p]=o.useState(null);o.useEffect(()=>{l(M())},[l]);const s=c.filter(t=>t.name.toLowerCase().includes(m.toLowerCase())),a=t=>{window.confirm("Yakin hapus produk ini?")&&l(K(t))},r=t=>{p(t),N(!0)},h=()=>{N(!1),p(null),l(M())};return e.jsxs("div",{className:"relative min-h-screen w-full bg-background/80 backdrop-blur-xl p-6",children:[e.jsxs("div",{className:"pointer-events-none absolute inset-0 overflow-hidden",children:[e.jsx("div",{className:"absolute -top-20 -left-20 w-[400px] h-[400px] bg-accent/20 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute -bottom-32 -right-24 w-[500px] h-[500px] bg-success/20 rounded-full blur-3xl animate-pulse"})]}),e.jsxs("div",{className:"sticky top-0 z-20 mb-6 flex flex-col gap-3 rounded-2xl bg-background/60 p-4 backdrop-blur-md shadow-sm border border-border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-extrabold text-foreground",children:"Product Manager"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{variant:u==="grid"?"default":"outline",size:"icon",onClick:()=>i("grid"),children:e.jsx(ee,{className:"h-4 w-4"})}),e.jsx(x,{variant:u==="list"?"default":"outline",size:"icon",onClick:()=>i("list"),children:e.jsx(se,{className:"h-4 w-4"})}),e.jsxs(x,{onClick:()=>{b(null),d(!0)},className:"btn-accent flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4"})," Add"]})]})]}),e.jsx(v,{placeholder:"Cari produk...",value:m,onChange:t=>g(t.target.value),className:"w-full md:w-72"})]}),n==="loading"?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsx(V,{className:"h-10 w-10 animate-spin text-accent"})}):j?e.jsx("p",{className:"text-center text-destructive",children:j}):s.length===0?e.jsx("p",{className:"text-center text-muted-foreground",children:"No products found."}):e.jsx("div",{className:`grid gap-4 ${u==="grid"?"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3":"grid-cols-1"}`,children:s.map(t=>e.jsxs(A,{className:"group relative rounded-2xl border border-border bg-card/60 backdrop-blur-xl shadow-md hover:shadow-xl transition",children:[e.jsx(D,{className:"p-0",children:e.jsx("div",{className:"relative h-40 overflow-hidden rounded-t-2xl",children:t.images&&t.images.length>0?e.jsx("img",{src:t.images[0].url,alt:t.images[0].alt||t.name,className:"h-full w-full object-cover"}):e.jsx("img",{src:"/placeholder.png",alt:"No Image",className:"h-full w-full object-cover"})})}),e.jsxs(F,{className:"p-4 space-y-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:t.name}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:t.description}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(I,{variant:"success",children:["Rp ",t.price.toLocaleString("id-ID")]}),e.jsxs(I,{variant:t.stock>0?"info":"error",children:["Stock: ",t.stock]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{size:"sm",variant:"outline",onClick:()=>r(t),className:"flex-1",children:[e.jsx(z,{className:"w-3 h-3 mr-1"}),"Stock"]}),e.jsx(x,{size:"sm",variant:"outline",onClick:()=>{b(t),d(!0)},children:"Edit"}),e.jsx(x,{size:"sm",variant:"destructive",onClick:()=>a(t._id),children:"Delete"})]})]})]})]},t._id))}),y&&e.jsx(ie,{open:y,onClose:()=>d(!1),product:f,loading:n==="loading",onSubmit:async t=>{try{f?await l(Z({id:f._id,productData:t})).unwrap():await l(J(t)).unwrap(),d(!1)}catch(E){console.error("Save failed:",E)}}}),e.jsx(ce,{isOpen:S,onClose:h,product:C})]})}export{pe as default};
