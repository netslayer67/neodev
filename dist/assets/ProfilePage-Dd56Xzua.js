const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Review-X8GkDJ2H.js","assets/index-BsrOXSwk.js","assets/index-Bbr9ih44.css","assets/message-square-CXAVvij8.js"])))=>i.map(i=>d[i]);
import{u as H,h as F,H as Q,i as G,b as J,r as a,a as A,J as X,K as W,M as Y,j as e,m as d,B as k,I as Z,N as L,U as z,o as M,c as O,A as R,X as ee,_ as se}from"./index-BsrOXSwk.js";import{C as te}from"./chevron-left-DplPwSSN.js";import{L as S}from"./log-out-BtL99yf5.js";import{S as ae}from"./search-NrxTJOFq.js";import{C as ne}from"./check-circle-Ba7LOwpH.js";const re=a.lazy(()=>se(()=>import("./Review-X8GkDJ2H.js"),__vite__mapDeps([0,1,2,3]))),le=(s="")=>String(s).slice(0,80).replace(/(<([^>]+)>)/gi,"").replace(/https?:\/\/[^"]+/gi,"").trim(),ie=(s,l)=>{const[c,o]=a.useState(s);return a.useEffect(()=>{const n=setTimeout(()=>o(s),l);return()=>clearTimeout(n)},[s,l]),c},T=a.memo(({order:s,onClick:l,reduceMotion:c})=>{const o=a.useMemo(()=>{switch(s.status){case"Delivered":return"bg-success/20 text-success";case"Cancelled":return"bg-error/20 text-error";default:return"bg-warning/20 text-warning"}},[s.status]),n=a.useMemo(()=>new Date(s.createdAt).toLocaleDateString("id-ID"),[s.createdAt]),i=a.useMemo(()=>s.totalAmount.toLocaleString("id-ID"),[s.totalAmount]),N=a.useMemo(()=>{const w=s.items?.[0]?.name||"",y=s.items?.length>1?` +${s.items.length-1} lainnya`:"";return w+y},[s.items]),r=a.useCallback(()=>l(s),[s,l]),m=c?"button":d.button,p=c?{}:{whileHover:{scale:1.01},transition:{duration:.2}};return e.jsxs(m,{...p,onClick:r,className:"w-full text-left p-4 rounded-2xl glass-card flex items-center justify-between gap-4 will-change-transform",children:[e.jsx("div",{className:"flex items-start gap-3 min-w-0 flex-1",children:e.jsxs("div",{className:"min-w-0",children:[e.jsxs("p",{className:"text-sm font-mono text-muted-foreground truncate",children:["#",s.orderId]}),e.jsx("p",{className:"text-sm text-foreground truncate",children:N}),e.jsx("p",{className:"text-xs text-muted-foreground",children:n})]})}),e.jsxs("div",{className:"flex flex-col items-end flex-shrink-0",children:[e.jsxs("p",{className:"font-bold text-secondary",children:["Rp ",i]}),e.jsx("span",{className:`text-[0.563rem] px-3 py-1 rounded-full mt-2 whitespace-nowrap ${o}`,children:s.status})]})]})});T.displayName="OrderRow";const v=a.memo(({icon:s,label:l,isActive:c,onClick:o,className:n=""})=>e.jsxs("button",{onClick:o,className:`flex-1 py-2 flex flex-col items-center gap-1 transition-colors duration-200 ${c?"text-foreground":"text-muted-foreground"} ${n}`,children:[e.jsx(s,{size:18}),e.jsx("span",{className:"text-xs",children:l})]}));v.displayName="NavButton";const $=a.memo(({user:s})=>e.jsx(d.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:"space-y-4",children:e.jsx("div",{className:"glass-card p-4 rounded-2xl",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-lg bg-card/80 flex items-center justify-center overflow-hidden flex-shrink-0",children:e.jsx(z,{size:28})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-semibold text-lg truncate",children:s?.name}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:s?.email}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Bergabung ",new Date(s?.createdAt).toLocaleDateString("id-ID")]})]})]})})}));$.displayName="UserProfile";const fe=()=>{const s=H(),l=F(),c=Q(),{toast:o}=G(),n=J(),[i,N]=a.useState(c.state?.activeView||"orders"),[r,m]=a.useState(null),[p,w]=a.useState(""),[y,P]=a.useState(!1),g=ie(p,300),{user:f,status:oe}=A(t=>t.auth||{}),{myOrders:j=[],status:h}=A(t=>t.orders||{});a.useEffect(()=>{f&&h==="idle"&&s(X())},[f,s,h]),a.useEffect(()=>(document.body.style.overflow=r?"hidden":"",()=>{document.body.style.overflow=""}),[r]);const C=a.useCallback(()=>{s(W()),l("/")},[s,l]),B=a.useCallback(t=>{m(t)},[]),V=a.useCallback(async()=>{if(r)try{await s(Y(r.orderId)).unwrap(),o({title:"Pesanan Dibatalkan",description:`Pesanan #${r.orderId} berhasil dibatalkan.`}),m(null),P(!0),setTimeout(()=>P(!1),2e3)}catch(t){o({variant:"destructive",title:"Gagal",description:t.message||"Terjadi kesalahan."})}},[s,r,o]),_=a.useCallback(t=>{w(t.target.value)},[]),D=a.useCallback(()=>{m(null)},[]),x=a.useCallback(t=>{N(t)},[]),I=a.useMemo(()=>{if(!Array.isArray(j))return[];const t=j.filter(b=>b.status!=="Cancelled");if(!g)return t;const u=le(g).toLowerCase();return t.filter(b=>b.orderId.toLowerCase().includes(u)||b.items?.some(q=>(q.name||"").toLowerCase().includes(u)))},[j,g]),E=a.useMemo(()=>f?.name?.split?.(" ")[0]||"User",[f?.name]),K=a.useMemo(()=>({initial:{opacity:0},animate:{opacity:1},transition:{duration:n?.1:.3}}),[n]),U=a.useMemo(()=>({initial:{opacity:0,y:n?0:40},animate:{opacity:1,y:0},exit:{opacity:0,y:n?0:40},transition:{duration:n?.1:.32}}),[n]);return e.jsxs(d.div,{className:"relative min-h-screen pt-20 pb-24 px-4 text-foreground font-sans",...K,children:[!n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute -top-24 -left-20 w-72 h-72 bg-accent/25 rounded-full blur-3xl will-change-transform"}),e.jsx("div",{className:"absolute -bottom-28 -right-20 w-96 h-96 bg-secondary/30 rounded-full blur-3xl will-change-transform"})]}),e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("header",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("h1",{className:"text-2xl font-heading font-bold truncate",children:["Halo, ",E," ðŸ‘‹"]}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Kelola akun & pesanan Anda"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(k,{variant:"ghost",size:"icon",onClick:()=>l(-1),className:"rounded-lg border border-border","aria-label":"Kembali",children:e.jsx(te,{size:18})}),e.jsx(k,{variant:"ghost",size:"icon",onClick:C,className:"rounded-lg border border-border","aria-label":"Keluar",children:e.jsx(S,{size:18})})]})]}),e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-6",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Z,{value:p,onChange:_,placeholder:"Cari pesanan atau produk...",className:"pl-10 bg-card/60 border border-border rounded-xl focus:ring-2 focus:ring-accent/30 transition-all duration-200","aria-label":"Pencarian pesanan"}),e.jsx(ae,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground pointer-events-none",size:18})]})}),e.jsxs("div",{className:"space-y-6",children:[i==="account"&&e.jsx($,{user:f}),i==="orders"&&e.jsxs(d.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:n?.1:.3},className:"space-y-4",children:[h==="loading"&&e.jsx(L,{}),e.jsxs("div",{className:"flex flex-col gap-3",children:[h==="succeeded"&&I.length===0&&e.jsx("div",{className:"glass-card p-6 text-center text-muted-foreground",children:g?"Tidak ada pesanan yang cocok.":"Belum ada pesanan."}),h==="succeeded"&&I.map(t=>e.jsx(T,{order:t,onClick:B,reduceMotion:n},t.orderId))]})]}),i==="reviews"&&e.jsx(d.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:n?.1:.3},children:e.jsx(a.Suspense,{fallback:e.jsx(L,{}),children:e.jsx(re,{products:j.flatMap(t=>t.items.map(u=>u.productData||u)),onSubmit:t=>console.log("Review:",t)})})})]})]}),e.jsxs("nav",{className:"fixed left-1/2 -translate-x-1/2 bottom-4 z-40 w-[94%] max-w-3xl flex items-center justify-between glass-card px-3 py-2 rounded-3xl shadow-xl md:hidden",children:[e.jsx(v,{icon:z,label:"Info",isActive:i==="account",onClick:()=>x("account")}),e.jsx(v,{icon:M,label:"Pesanan",isActive:i==="orders",onClick:()=>x("orders")}),e.jsx(v,{icon:O,label:"Review",isActive:i==="reviews",onClick:()=>x("reviews")}),e.jsx("button",{onClick:C,className:"py-2 px-3 rounded-xl text-error transition-colors duration-200 hover:bg-error/10","aria-label":"Keluar",children:e.jsx(S,{size:18})})]}),e.jsx(R,{mode:"wait",children:r&&e.jsx(d.div,{className:"fixed inset-0 z-50 bg-overlay backdrop-blur-md flex justify-center items-end md:items-center p-4",...U,onClick:D,children:e.jsxs(d.div,{onClick:t=>t.stopPropagation(),className:"w-full md:max-w-lg glass-card p-6 rounded-t-2xl md:rounded-3xl will-change-transform",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold truncate flex-1",children:["Pesanan #",r.orderId]}),e.jsx("button",{onClick:D,className:"text-muted-foreground hover:text-foreground transition-colors p-1 flex-shrink-0","aria-label":"Tutup",children:e.jsx(ee,{size:20})})]}),e.jsx("div",{className:"space-y-3 text-sm text-foreground max-h-60 overflow-y-auto scrollbar-hide",children:r.items?.map((t,u)=>e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("span",{className:"truncate block",children:t.name}),t.size&&e.jsxs("span",{className:"text-muted-foreground text-xs",children:["(",t.size,") Ã— ",t.quantity]})]}),e.jsxs("div",{className:"font-mono flex-shrink-0",children:["Rp ",(t.price*t.quantity).toLocaleString("id-ID")]})]},`${t.product}-${u}`))}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-border",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("span",{className:"font-semibold",children:"Total:"}),e.jsxs("span",{className:"font-bold text-secondary",children:["Rp ",r.totalAmount.toLocaleString("id-ID")]})]}),["Diproses","Pending Payment"].includes(r.status)&&e.jsx(k,{variant:"destructive",className:"w-full",onClick:V,children:"Batalkan Pesanan"})]})]})})}),e.jsx(R,{children:y&&e.jsx(d.div,{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.3},children:e.jsx("div",{className:"bg-success/90 p-5 rounded-full shadow-2xl",children:e.jsx(ne,{className:"text-foreground",size:36})})})}),e.jsx("div",{className:"hidden md:block fixed top-32 right-6 w-48",children:e.jsxs("aside",{className:"glass-card p-3 rounded-2xl space-y-2",children:[e.jsxs("button",{onClick:()=>x("account"),className:`w-full text-left py-2 px-3 rounded-lg flex items-center gap-3 transition-colors duration-200 ${i==="account"?"bg-accent/20 text-foreground":"text-muted-foreground hover:bg-card/50"}`,children:[e.jsx(z,{size:16})," Info"]}),e.jsxs("button",{onClick:()=>x("orders"),className:`w-full text-left py-2 px-3 rounded-lg flex items-center gap-3 transition-colors duration-200 ${i==="orders"?"bg-accent/20 text-foreground":"text-muted-foreground hover:bg-card/50"}`,children:[e.jsx(M,{size:16})," Pesanan"]}),e.jsxs("button",{onClick:()=>x("reviews"),className:`w-full text-left py-2 px-3 rounded-lg flex items-center gap-3 transition-colors duration-200 ${i==="reviews"?"bg-accent/20 text-foreground":"text-muted-foreground hover:bg-card/50"}`,children:[e.jsx(O,{size:16})," Review"]}),e.jsxs("button",{onClick:C,className:"w-full text-left py-2 px-3 rounded-lg flex items-center gap-3 text-error hover:bg-error/10 transition-colors duration-200",children:[e.jsx(S,{size:16})," Keluar"]})]})})]})};export{fe as default};
